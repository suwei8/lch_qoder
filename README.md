# æ´—è½¦IOTç®¡ç†ç³»ç»Ÿ ğŸš—ğŸ’§

[![æŠ€æœ¯æ ˆ](https://img.shields.io/badge/Stack-NestJS%20%2B%20Vue3-brightgreen)](https://github.com/suwei8/lch_qoder)
[![æ•°æ®åº“](https://img.shields.io/badge/Database-MySQL%20%2B%20Redis-blue)](https://github.com/suwei8/lch_qoder)
[![éƒ¨ç½²](https://img.shields.io/badge/Deploy-Docker-orange)](https://github.com/suwei8/lch_qoder)

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

æ´—è½¦IOTç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºç‰©è”ç½‘æŠ€æœ¯çš„æ™ºèƒ½æ´—è½¦æœåŠ¡å¹³å°ï¼Œé€šè¿‡å¾®ä¿¡ç”Ÿæ€å®ç°ç”¨æˆ·æ‰«ç æ´—è½¦ã€å•†æˆ·è®¾å¤‡ç®¡ç†ã€å¹³å°è¿è¥ç›‘æ§çš„å®Œæ•´ä¸šåŠ¡é—­ç¯ã€‚

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

- **ğŸ” ç»Ÿä¸€è®¤è¯** - JWT + å¾®ä¿¡OAuthåŒé‡è®¤è¯ä½“ç³»
- **ğŸ“± å¾®ä¿¡ç”Ÿæ€** - å…¬ä¼—å·H5ã€æ¨¡æ¿æ¶ˆæ¯ã€JSAPIæ”¯ä»˜
- **ğŸª å•†æˆ·ç®¡ç†** - è®¾å¤‡ç›‘æ§ã€è®¢å•æµæ°´ã€è´¢åŠ¡æç°
- **ğŸ–¥ï¸ å¹³å°è¿è¥** - æ•°æ®çœ‹æ¿ã€å•†æˆ·å®¡æ ¸ã€ç³»ç»Ÿé…ç½®
- **ğŸ’° æ”¯ä»˜ä½“ç³»** - å¾®ä¿¡æ”¯ä»˜ + ä½™é¢æ”¯ä»˜ + è‡ªåŠ¨åˆ†æ¶¦
- **ğŸ“¡ è®¾å¤‡å¯¹æ¥** - æ™ºé“¾ç‰©è”è®¾å¤‡è¿œç¨‹æ§åˆ¶ä¸çŠ¶æ€ç›‘æ§

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·ç«¯ (H5)    â”‚  â”‚  å•†æˆ·ç«¯(PC+H5)   â”‚  â”‚  å¹³å°ç«¯(PC+H5)   â”‚
â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚
â”‚ â€¢ å¾®ä¿¡æ‰«ç æ´—è½¦   â”‚  â”‚ â€¢ è®¾å¤‡ç®¡ç†       â”‚  â”‚ â€¢ å•†æˆ·å®¡æ ¸       â”‚
â”‚ â€¢ è®¢å•æ”¯ä»˜      â”‚  â”‚ â€¢ è®¢å•æŸ¥çœ‹       â”‚  â”‚ â€¢ æ•°æ®ç»Ÿè®¡       â”‚
â”‚ â€¢ ä½™é¢å……å€¼      â”‚  â”‚ â€¢ è´¢åŠ¡æç°       â”‚  â”‚ â€¢ ç³»ç»Ÿé…ç½®       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚            åç«¯æœåŠ¡                  â”‚
                â”‚                                    â”‚
                â”‚ ğŸ” è®¤è¯æˆæƒ  ğŸ“‹ è®¢å•ç®¡ç†  ğŸª å•†æˆ·ç®¡ç†  â”‚
                â”‚ ğŸ“¡ è®¾å¤‡ç®¡ç†  ğŸ’° æ”¯ä»˜ç®¡ç†  ğŸ“¢ é€šçŸ¥æœåŠ¡  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚           æ•°æ®å±‚                     â”‚
                â”‚                                    â”‚
                â”‚    ğŸ“Š MySQL     ğŸš€ Redis            â”‚
                â”‚    ä¸šåŠ¡æ•°æ®      ç¼“å­˜/ä¼šè¯            â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯
- **æ¡†æ¶**: NestJS + TypeScript
- **æ•°æ®åº“**: MySQL 8.0 + Redis 6.0
- **è®¤è¯**: JWT + å¾®ä¿¡OAuth
- **æ”¯ä»˜**: å¾®ä¿¡æ”¯ä»˜JSAPI
- **è®¾å¤‡**: æ™ºé“¾ç‰©è”IoTåè®®
- **éƒ¨ç½²**: Docker + Docker Compose

### å‰ç«¯æŠ€æœ¯
- **æ¡†æ¶**: Vue 3 + TypeScript
- **UIç»„ä»¶**: Element Plus
- **çŠ¶æ€ç®¡ç†**: Pinia
- **æ„å»ºå·¥å…·**: Vite
- **è·¯ç”±**: Vue Router 4

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 16.0.0
- MySQL >= 8.0
- Redis >= 6.0
- Docker & Docker Compose (æ¨è)

### ğŸ³ Docker ä¸€é”®å¯åŠ¨ (æ¨è)

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/suwei8/lch_qoder.git
cd lch_qoder

# å¯åŠ¨æ•°æ®åº“æœåŠ¡
docker-compose -f docker-compose.db.yml up -d

# å¿«é€Ÿå¯åŠ¨å¼€å‘ç¯å¢ƒ
./quick-start.bat  # Windows
# æˆ–
./start-dev.ps1   # PowerShell
```

### ğŸ”§ æ‰‹åŠ¨å®‰è£…

```bash
# 1. å¯åŠ¨æ•°æ®åº“
docker-compose -f docker-compose.db.yml up -d

# 2. å®‰è£…åç«¯ä¾èµ–å¹¶å¯åŠ¨
cd lch-backend
npm install
npm run start:dev

# 3. å®‰è£…å‰ç«¯ä¾èµ–å¹¶å¯åŠ¨ (æ–°ç»ˆç«¯)
cd lch-platform
npm install
npm run dev
```

### ğŸ“Š åˆå§‹åŒ–æ•°æ®

```sql
-- å¯¼å…¥åˆå§‹åŒ–SQL
mysql -u root -p < docs/database/init.sql
```

### ğŸŒ è®¿é—®åœ°å€

- **å¹³å°ç®¡ç†ç«¯**: http://localhost:5173
- **åç«¯API**: http://localhost:3000
- **APIæ–‡æ¡£**: http://localhost:3000/api

## ğŸ“ é¡¹ç›®ç»“æ„

```
lch_qoder/
â”œâ”€â”€ ğŸ“‚ lch-backend/              # åç«¯æœåŠ¡ (NestJS)
â”‚   â”œâ”€â”€ ğŸ“‚ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ” auth/             # è®¤è¯æˆæƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ ğŸ‘¥ users/            # ç”¨æˆ·ç®¡ç†æ¨¡å—  
â”‚   â”‚   â”œâ”€â”€ ğŸª merchants/        # å•†æˆ·ç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ ğŸ“‹ orders/           # è®¢å•ç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ ğŸ“¡ devices/          # è®¾å¤‡ç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ ğŸ’° payments/         # æ”¯ä»˜ç®¡ç†æ¨¡å—
â”‚   â”‚   â””â”€â”€ ğŸ”§ common/           # å…¬å…±æœåŠ¡æ¨¡å—
â”‚   â””â”€â”€ ğŸ“„ package.json
â”œâ”€â”€ ğŸ“‚ lch-platform/             # å¹³å°ç®¡ç†ç«¯ (Vue3)
â”‚   â”œâ”€â”€ ğŸ“‚ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ¨ views/            # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ğŸ”Œ api/              # APIæ¥å£
â”‚   â”‚   â”œâ”€â”€ ğŸ“ types/            # TypeScriptç±»å‹
â”‚   â”‚   â”œâ”€â”€ ğŸ—‚ï¸ stores/           # PiniaçŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ ğŸ­ layout/           # å¸ƒå±€ç»„ä»¶
â”‚   â””â”€â”€ ğŸ“„ package.json
â”œâ”€â”€ ğŸ“‚ doc/                      # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ ğŸ“‚ docs/                     # æ•°æ®åº“æ–‡æ¡£
â”œâ”€â”€ ğŸ³ docker-compose.db.yml     # æ•°æ®åº“Dockeré…ç½®
â”œâ”€â”€ ğŸš€ quick-start.bat          # å¿«é€Ÿå¯åŠ¨è„šæœ¬
â””â”€â”€ ğŸ“– README.md                # é¡¹ç›®è¯´æ˜
```

## ğŸ”§ å¼€å‘è„šæœ¬

| è„šæœ¬ | è¯´æ˜ |
|------|------|
| `quick-start.bat` | ä¸€é”®å¯åŠ¨å¼€å‘ç¯å¢ƒ |
| `start-backend.bat` | å¯åŠ¨åç«¯æœåŠ¡ |
| `start-dev.bat` | å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡ |
| `start-dev-cn.bat` | ä½¿ç”¨å›½å†…é•œåƒå¯åŠ¨ |
| `fix-ports.ps1` | ä¿®å¤ç«¯å£å ç”¨é—®é¢˜ |

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒæ•°æ®è¡¨

- **ğŸ‘¥ users** - ç”¨æˆ·ä¿¡æ¯è¡¨
- **ğŸª merchants** - å•†æˆ·ä¿¡æ¯è¡¨  
- **ğŸ“¡ devices** - è®¾å¤‡ä¿¡æ¯è¡¨
- **ğŸ“‹ orders** - è®¢å•ä¿¡æ¯è¡¨
- **ğŸ’° payments** - æ”¯ä»˜è®°å½•è¡¨
- **ğŸ“¢ notifications** - é€šçŸ¥è®°å½•è¡¨

### ğŸ“ˆ ç´¢å¼•ä¼˜åŒ–

- ç”¨æˆ·å¾®ä¿¡OpenIDç´¢å¼•
- è®¢å•çŠ¶æ€å’Œæ—¶é—´å¤åˆç´¢å¼•
- è®¾å¤‡å•†æˆ·å…³è”ç´¢å¼•
- æ”¯ä»˜æµæ°´å·å”¯ä¸€ç´¢å¼•

## ğŸ”Œ APIæ¥å£

### è®¤è¯æ¥å£
```http
POST /auth/wechat/login    # å¾®ä¿¡ç™»å½•
POST /auth/refresh         # åˆ·æ–°Token
GET  /auth/profile         # è·å–ç”¨æˆ·ä¿¡æ¯
```

### è®¾å¤‡ç®¡ç†
```http
GET    /devices            # è®¾å¤‡åˆ—è¡¨
POST   /devices/:id/control # è®¾å¤‡æ§åˆ¶
GET    /devices/:id/status  # è®¾å¤‡çŠ¶æ€
```

### è®¢å•ç®¡ç†
```http
POST   /orders             # åˆ›å»ºè®¢å•
GET    /orders             # è®¢å•åˆ—è¡¨
POST   /orders/:id/pay     # è®¢å•æ”¯ä»˜
```

## ğŸš€ éƒ¨ç½²è¯´æ˜

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

```bash
# 1. æ„å»ºåç«¯
cd lch-backend
npm run build

# 2. æ„å»ºå‰ç«¯
cd lch-platform  
npm run build

# 3. ä½¿ç”¨Dockeréƒ¨ç½²
docker-compose up -d
```

### ç¯å¢ƒå˜é‡é…ç½®

å¤åˆ¶å¹¶é…ç½®ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼š
```bash
cp lch-backend/.env.example lch-backend/.env
```

å…³é”®é…ç½®é¡¹ï¼š
- `DATABASE_URL` - MySQLè¿æ¥åœ°å€
- `REDIS_URL` - Redisè¿æ¥åœ°å€  
- `JWT_SECRET` - JWTå¯†é’¥
- `WECHAT_APPID` - å¾®ä¿¡AppID
- `WECHAT_SECRET` - å¾®ä¿¡AppSecret

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æäº¤ Pull Request

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-01-05)
- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- ğŸ” å®Œæˆç”¨æˆ·è®¤è¯ä½“ç³»
- ğŸ“± é›†æˆå¾®ä¿¡ç”Ÿæ€åŠŸèƒ½
- ğŸª å®ç°å•†æˆ·ç®¡ç†åŠŸèƒ½
- ğŸ“¡ å¯¹æ¥æ™ºé“¾ç‰©è”è®¾å¤‡
- ğŸ’° å®Œæˆæ”¯ä»˜ä½“ç³»å¼€å‘

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®ç»´æŠ¤è€…**: suwei8
- **GitHub**: https://github.com/suwei8/lch_qoder
- **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/suwei8/lch_qoder/issues)

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Star æ”¯æŒä¸€ä¸‹ï¼