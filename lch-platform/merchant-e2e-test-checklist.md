# 商户端E2E测试检查清单

## 🎯 测试目标
验证商户端系统所有功能正常运行，确保菜单跳转正确，不会错误跳转到平台管理后台。

## 📋 测试清单

### 1. 商户登录测试
**测试地址**: http://localhost:5602/merchant-login

**检查项目**:
- [ ] 页面正常加载，显示绿色主题商户登录界面
- [ ] 6个测试商户账号列表正常显示
- [ ] 一键登录功能正常（点击任意测试账号）
- [ ] 登录成功后正确跳转到 `/merchant/dashboard`
- [ ] 页面标题显示为 "商户后台 - 亮车惠商户管理后台"

**测试账号**:
- 测试洗车店 (13900139001)
- 青青洗车服务中心 (13900139002)  
- 星光汽车美容服务有限公司 (13900139003)
- 蓝天汽车服务连锁店 (13900139004)
- 快洁自助洗车服务站 (13900139005)
- 洁净汽车美容养护中心 (13900139006)

### 2. 商户布局组件测试
**测试地址**: http://localhost:5602/merchant/dashboard (登录后)

**检查项目**:
- [ ] 顶部标题显示 "亮车惠 · 商户管理后台" (绿色主题)
- [ ] 用户信息正确显示选择的测试商户名称
- [ ] 左侧导航栏显示8个商户专属菜单项
- [ ] 菜单样式使用绿色激活色 (#52c41a)

### 3. 商户菜单功能测试

#### 3.1 仪表盘 (/merchant/dashboard)
- [ ] 菜单点击正确跳转，不跳转到平台管理后台
- [ ] 页面正常加载，显示商户数据概览
- [ ] URL正确显示为 `/merchant/dashboard`
- [ ] 页面标题正确显示为 "商户后台 - 亮车惠商户管理后台"

#### 3.2 设备管理 (/merchant/devices)  
- [ ] 菜单点击正确跳转，不跳转到平台管理后台
- [ ] 页面正常加载，显示设备列表和状态
- [ ] URL正确显示为 `/merchant/devices`
- [ ] 页面标题正确显示为 "设备管理 - 亮车惠商户管理后台"

#### 3.3 订单管理 (/merchant/orders)
- [ ] 菜单点击正确跳转，不跳转到平台管理后台
- [ ] 页面正常加载，显示订单列表
- [ ] URL正确显示为 `/merchant/orders`
- [ ] 页面标题正确显示为 "订单管理 - 亮车惠商户管理后台"

#### 3.4 财务管理 (/merchant/finance)
- [ ] 菜单点击正确跳转，不跳转到平台管理后台
- [ ] 页面正常加载，显示财务数据
- [ ] URL正确显示为 `/merchant/finance`
- [ ] 页面标题正确显示为 "财务管理 - 亮车惠商户管理后台"

#### 3.5 客户管理 (/merchant/customers) ⭐新增
- [ ] 菜单点击正确跳转，不跳转到平台管理后台
- [ ] 页面正常加载，显示客户列表
- [ ] URL正确显示为 `/merchant/customers`
- [ ] 页面标题正确显示为 "客户管理 - 亮车惠商户管理后台"

#### 3.6 营销工具 (/merchant/marketing) ⭐新增
- [ ] 菜单点击正确跳转，不跳转到平台管理后台
- [ ] 页面正常加载，显示营销功能
- [ ] URL正确显示为 `/merchant/marketing`
- [ ] 页面标题正确显示为 "营销工具 - 亮车惠商户管理后台"

#### 3.7 数据报表 (/merchant/reports) ⭐新增
- [ ] 菜单点击正确跳转，不跳转到平台管理后台
- [ ] 页面正常加载，显示数据报表
- [ ] URL正确显示为 `/merchant/reports`
- [ ] 页面标题正确显示为 "数据报表 - 亮车惠商户管理后台"

#### 3.8 商户设置 (/merchant/settings) ⭐新增
- [ ] 菜单点击正确跳转，不跳转到平台管理后台
- [ ] 页面正常加载，显示设置界面
- [ ] URL正确显示为 `/merchant/settings`
- [ ] 页面标题正确显示为 "商户设置 - 亮车惠商户管理后台"

### 4. 权限隔离测试
- [ ] 商户登录后无法访问平台管理后台页面（如 `/dashboard`, `/merchants` 等）
- [ ] 直接访问平台端URL时正确重定向或显示权限错误
- [ ] 商户端和平台端的导航菜单完全独立

### 5. 退出登录测试
- [ ] 点击用户头像下拉菜单
- [ ] 选择"退出登录"功能正常
- [ ] 退出后正确跳转到 `/merchant-login` 而不是 `/login`

## 🔧 修复内容总结

### 问题诊断
1. **根本原因**: 商户端共用了平台端的布局组件 (`/layout/index.vue`)
2. **菜单问题**: `Sidebar.vue` 组件只显示 `Layout` 路由的子路由，不显示 `MerchantLayout` 路由
3. **认证问题**: 模拟登录token格式不匹配认证检查逻辑

### 解决方案
1. **创建商户专用布局**: `/layout/merchant.vue`
2. **创建商户专用侧边栏**: `/layout/components/MerchantSidebar.vue`
3. **完善商户页面**: 新增4个缺失的功能页面
4. **修复认证逻辑**: 支持 `mock-merchant-token` 格式
5. **路由权限隔离**: 区分商户端和平台端访问权限

### 新增文件
- `/layout/merchant.vue` - 商户专用布局组件
- `/layout/components/MerchantSidebar.vue` - 商户专用侧边栏
- `/views/merchant/customers.vue` - 客户管理页面
- `/views/merchant/marketing.vue` - 营销工具页面  
- `/views/merchant/reports.vue` - 数据报表页面
- `/views/merchant/settings.vue` - 商户设置页面

## ✅ 预期结果
- 所有商户菜单点击后正确跳转到对应的商户页面
- 不会再错误跳转到"平台管理后台"
- 商户端与平台端完全隔离，界面主题区分明显
- 8个商户功能页面全部可访问且正常工作